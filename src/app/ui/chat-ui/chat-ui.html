<div
  class="rounded-lg shadow-lg overflow-hidden border flex flex-col h-[90vh]"
>
  <!-- Header -->
  <div
    class="bg-card-header p-4 border-b flex items-center justify-between"
  >
    <h3 class="text-lg font-semibold">{{ title() }}</h3>
    <span class="text-xs text-chat-online font-medium flex items-center gap-1">
      <span class="w-2 h-2 rounded-full bg-chat-online "></span> Online ({{ online() }})
    </span>
  </div>

  <!-- Messages Area -->
  <div #scrollContainer class="bg-card overflow-y-auto p-4 space-y-4 flex-1">
    @for (msg of messages(); track msg.id) {
    <div
      class="flex flex-col"
      [class.items-end]="msg.userid === user()?.uid"
      [class.items-start]="msg.userid !== user()?.uid"
    >
      @if(msg.userid !== user()?.uid){
      <div class="flex gap-2 items-end">
        <img [src]="msg.avatar" [alt]="msg.username" class="w-6 h-6 rounded-full ring-2 ring-chat-bubble-secondary" />

        <div
          [innerHTML]="msg?.message"
          class="max-w-[80%] px-4 py-2 rounded-2xl text-sm shadow-sm bg-chat-bubble-secondary "
         
        ></div>
      </div>
      <span class="text-[10px] text-chat-time mt-1 px-1">
        {{ msg.created | date : 'shortTime' }}
      </span>
      } @else {
      <div
        [innerHTML]="msg?.message"
        class="max-w-[80%] px-4 py-2 rounded-2xl text-sm shadow-sm bg-chat-bubble-primary"
       
      ></div>
      <span class="text-[10px] text-chat-time mt-1 px-1">
        {{ msg.created | date : 'shortTime' }}
      </span>
      }

      
    </div>
    }
  </div>

  <!-- Input Area -->
  <div class="p-4 bg-card-header border-t">
    <form (submit)="sendMessage()" class="flex items-center gap-2">
      <input
        type="text"
        [formField]="chatForm.message"
        placeholder="Type a message..."
        class="flex-1 px-4 py-2 rounded-full bg-input text-input-foreground focus:outline-none focus:ring-2 focus:ring-blue-500 border-none placeholder-gray-400"
      />
      <button
        type="submit"
        class="p-2 rounded-full bg-secondary text-secondary-foreground transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed"
        [disabled]="chatForm.message().invalid()"
      >
        <lucide-angular [name]="sendHorizontal"></lucide-angular>
      </button>
    </form>
  </div>
</div>
